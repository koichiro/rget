#!/usr/bin/env ruby

require 'thor'
require 'webradio'

class GetWebRadio < Thor
	class_option :mp3, :type=>:boolean, :default=>false, :desc=>'convert to mp3 with ffmpeg'

	desc 'imas_cg', 'download THE iDOLM@STER Cinderella Girls Radio'
	def imas_cg
		process('http://hibiki-radio.jp/description/imas_cg', 'デレラジ')
	end

	desc 'imachu', 'download Radio de ima-chu!!'
	def imachu
		process('http://sp.animate.tv/radio/details.php?id=imas_chu', 'アイマCHU!')
	end

	desc 'imastudio', 'download imastudio'
	def imastudio
		process('http://hibiki-radio.jp/description/idolmaster', 'アイスタ')
	end

	desc 'bahamut', 'download Radio Shingeki-no-Bahamut'
	def bahamut
		process('http://hibiki-radio.jp/description/bahamut', 'バハムート')
	end

  desc 'st501', 'download Radio 501'
  def st501
    process('http://hibiki-radio.jp/description/501st', 'ストパン501')
  end

  desc 'yomecolle', 'download Yomecolle radio'
  def yomecolle
    process('http://sp.animate.tv/radio/details.php?id=yomecolle-r', '嫁コレ')
  end

private
	def process(uri, label)
		WebRadio.new(uri) do |radio|
			radio.download(label)
			radio.mp3ize if options.mp3?
		end
	end
end

GetWebRadio.start(ARGV)
